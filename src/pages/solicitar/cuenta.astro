---
import Layout from "../../layouts/Layout.astro";
import SectionContainer from "../../components/SectionContainer.astro";
---

<Layout
  title="Pedido con Cuenta - Agua Máxima"
  description="Inicia sesión para gestionar tu pedido con carrito, historial y direcciones guardadas"
>
  <SectionContainer>
    <!-- Header Section -->
    <div class="relative isolate px-6 pt-14 pb-20 lg:px-8">
      <div class="mx-auto max-w-6xl">
        <!-- Header -->
        <div class="text-center mb-12">
          <h1
            class="text-4xl font-bold tracking-tight text-gray-900 sm:text-5xl mb-6"
          >
            <span class="text-[#0288c7]">Pedido con</span>
            <span class="text-[#083049]">Cuenta</span>
          </h1>
          <p class="text-lg text-gray-600 max-w-2xl mx-auto">
            Inicia sesión para acceder a tu carrito, historial de pedidos y
            direcciones guardadas
          </p>
        </div>

        <!-- Login Section -->
        <div id="login-section" class="max-w-md mx-auto">
          <div
            class="bg-gradient-to-br from-[#bae7fd]/20 to-[#7dd5fc]/10 rounded-xl border border-[#7dd5fc]/30 p-8"
          >
            <div class="text-center mb-6">
              <div
                class="w-16 h-16 bg-[#0288c7] rounded-full flex items-center justify-center mx-auto mb-4"
              >
                <svg
                  class="w-8 h-8 text-white"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
                  ></path>
                </svg>
              </div>
              <h2 class="text-2xl font-semibold text-[#083049] mb-2">
                Iniciar Sesión
              </h2>
              <p class="text-gray-600">
                Accede a tu cuenta para continuar con tu pedido
              </p>
            </div>

            <form id="login-form" class="space-y-4">
              <div>
                <label
                  for="email"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Correo electrónico</label
                >
                <input
                  type="email"
                  id="email"
                  name="email"
                  required
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0288c7] focus:border-[#0288c7]"
                  placeholder="tu@email.com"
                />
              </div>

              <div>
                <label
                  for="password"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Contraseña</label
                >
                <input
                  type="password"
                  id="password"
                  name="password"
                  required
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0288c7] focus:border-[#0288c7]"
                  placeholder="Tu contraseña"
                />
              </div>

              <button
                type="submit"
                class="w-full bg-[#0288c7] hover:bg-[#083049] text-white font-medium py-3 px-4 rounded-lg transition-colors duration-300 cursor-pointer"
              >
                Iniciar Sesión
              </button>
            </form>

            <div class="mt-6 text-center">
              <p class="text-sm text-gray-600">
                ¿No tienes cuenta?
                <button
                  id="show-register"
                  class="text-[#0288c7] hover:text-[#083049] font-medium cursor-pointer"
                  >Regístrate aquí</button
                >
              </p>
              <p class="mt-2 text-sm text-gray-600">
                <a href="#" class="text-[#0288c7] hover:text-[#083049]"
                  >¿Olvidaste tu contraseña?</a
                >
              </p>
            </div>
          </div>
        </div>

        <!-- Register Section (Hidden by default) -->
        <div id="register-section" class="max-w-md mx-auto hidden">
          <div
            class="bg-gradient-to-br from-[#bae7fd]/20 to-[#7dd5fc]/10 rounded-xl border border-[#7dd5fc]/30 p-8"
          >
            <div class="text-center mb-6">
              <div
                class="w-16 h-16 bg-[#0288c7] rounded-full flex items-center justify-center mx-auto mb-4"
              >
                <svg
                  class="w-8 h-8 text-white"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"
                  ></path>
                </svg>
              </div>
              <h2 class="text-2xl font-semibold text-[#083049] mb-2">
                Crear Cuenta
              </h2>
              <p class="text-gray-600">
                Regístrate para acceder a todos los beneficios
              </p>
            </div>

            <form id="register-form" class="space-y-4">
              <div>
                <label
                  for="reg-name"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Nombre completo</label
                >
                <input
                  type="text"
                  id="reg-name"
                  name="name"
                  required
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0288c7] focus:border-[#0288c7]"
                  placeholder="Tu nombre completo"
                />
              </div>

              <div>
                <label
                  for="reg-email"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Correo electrónico</label
                >
                <input
                  type="email"
                  id="reg-email"
                  name="email"
                  required
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0288c7] focus:border-[#0288c7]"
                  placeholder="tu@email.com"
                />
              </div>

              <div>
                <label
                  for="reg-phone"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Teléfono</label
                >
                <input
                  type="tel"
                  id="reg-phone"
                  name="phone"
                  required
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0288c7] focus:border-[#0288c7]"
                  placeholder="961-123-4567"
                />
              </div>

              <div>
                <label
                  for="reg-password"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Contraseña</label
                >
                <input
                  type="password"
                  id="reg-password"
                  name="password"
                  required
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0288c7] focus:border-[#0288c7]"
                  placeholder="Mínimo 6 caracteres"
                />
              </div>

              <button
                type="submit"
                class="w-full bg-[#0288c7] hover:bg-[#083049] text-white font-medium py-3 px-4 rounded-lg transition-colors duration-300 cursor-pointer"
              >
                Crear Cuenta
              </button>
            </form>

            <div class="mt-6 text-center">
              <p class="text-sm text-gray-600">
                ¿Ya tienes cuenta?
                <button
                  id="show-login"
                  class="text-[#0288c7] hover:text-[#083049] font-medium cursor-pointer"
                  >Inicia sesión</button
                >
              </p>
            </div>
          </div>
        </div>

        <!-- Shopping Section (Hidden until logged in) -->
        <div id="shopping-section" class="hidden">
          <!-- Progress Steps -->
          <div class="mb-12">
            <div
              class="flex items-center justify-center space-x-4 md:space-x-8"
            >
              <div class="flex items-center">
                <div
                  class="w-8 h-8 bg-[#0288c7] text-white rounded-full flex items-center justify-center text-sm font-medium"
                >
                  ✓
                </div>
                <span class="ml-2 text-sm font-medium text-[#0288c7]"
                  >Sesión iniciada</span
                >
              </div>
              <div class="w-8 h-0.5 bg-[#0288c7]"></div>
              <div class="flex items-center">
                <div
                  id="step-products-circle"
                  class="w-8 h-8 bg-[#0288c7] text-white rounded-full flex items-center justify-center text-sm font-medium"
                >
                  2
                </div>
                <span
                  id="step-products-text"
                  class="ml-2 text-sm font-medium text-[#0288c7]"
                  >Productos</span
                >
              </div>
              <div class="w-8 h-0.5 bg-gray-300"></div>
              <div class="flex items-center">
                <div
                  id="step-cart-circle"
                  class="w-8 h-8 bg-gray-300 text-gray-500 rounded-full flex items-center justify-center text-sm font-medium"
                >
                  3
                </div>
                <span
                  id="step-cart-text"
                  class="ml-2 text-sm font-medium text-gray-500">Carrito</span
                >
              </div>
              <div class="w-8 h-0.5 bg-gray-300"></div>
              <div class="flex items-center">
                <div
                  id="step-confirm-circle"
                  class="w-8 h-8 bg-gray-300 text-gray-500 rounded-full flex items-center justify-center text-sm font-medium"
                >
                  4
                </div>
                <span
                  id="step-confirm-text"
                  class="ml-2 text-sm font-medium text-gray-500">Confirmar</span
                >
              </div>
            </div>
          </div>

          <!-- User Welcome & Cart Toggle -->
          <div class="mb-8">
            <div
              class="bg-gradient-to-r from-[#bae7fd]/20 to-[#7dd5fc]/10 rounded-xl border border-[#7dd5fc]/30 p-6"
            >
              <div
                class="flex flex-col md:flex-row md:items-center md:justify-between"
              >
                <div>
                  <h2 class="text-xl font-semibold text-[#083049] mb-2">
                    ¡Bienvenido, <span id="user-name">Usuario</span>!
                  </h2>
                  <p class="text-gray-600">
                    Agrega productos a tu carrito y gestiona tu pedido
                  </p>
                </div>
                <div class="mt-4 md:mt-0 flex gap-3">
                  <!-- Ver Carrito -->
                  <button
                    id="toggle-cart"
                    class="inline-flex items-center px-4 py-2 bg-[#0288c7] text-white font-medium rounded-lg hover:bg-[#083049] transition-colors duration-300 cursor-pointer"
                  >
                    <svg
                      class="w-5 h-5 mr-2"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.5 6h14.5M7 13v6a2 2 0 002 2h10a2 2 0 002-2v-6"
                      ></path>
                    </svg>
                    Ver Carrito (<span id="cart-count">0</span>)
                  </button>
                  <button
                    id="logout-btn"
                    class="inline-flex items-center px-4 py-2 border border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors duration-300 cursor-pointer"
                  >
                    <svg
                      class="w-5 h-5 mr-2"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"
                      ></path>
                    </svg>
                    Cerrar Sesión
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div class="grid lg:grid-cols-3 gap-8">
            <!-- Products Grid -->
            <div class="lg:col-span-2">
              <div class="slide-in-left">
                <h3
                  class="text-2xl font-semibold text-[#083049] mb-6 flex items-center"
                >
                  <svg
                    class="w-6 h-6 mr-3 text-[#0288c7]"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"
                    ></path>
                  </svg>
                  Catálogo de Productos
                </h3>

                <div class="grid md:grid-cols-2 gap-6">
                  <!-- Product Cards -->
                                     <div
                     class="product-card bg-white rounded-xl border-2 border-[#7dd5fc]/30 hover:border-[#0288c7] transition-all duration-300 p-6 hover:shadow-lg"
                   >
                     <div class="text-center">
                       <div
                         class="w-20 h-20 bg-[#bae7fd]/50 rounded-full flex items-center justify-center mx-auto mb-4"
                       >
                         <svg
                           class="w-10 h-10 text-[#0288c7]"
                           fill="none"
                           stroke="currentColor"
                           viewBox="0 0 24 24"
                         >
                           <path
                             stroke-linecap="round"
                             stroke-linejoin="round"
                             stroke-width="2"
                             d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"
                           ></path>
                         </svg>
                       </div>
                       <h4 class="text-lg font-semibold text-[#083049] mb-2">
                         Garrafón 20L
                       </h4>
                       <p class="text-gray-600 text-sm mb-4">
                         Agua purificada de la más alta calidad
                       </p>
                       <p class="text-xl font-bold text-[#0288c7] mb-4">
                         $25.00
                       </p>
                       
                       <div class="flex items-center justify-center space-x-3">
                         <button class="quantity-btn minus bg-gray-200 hover:bg-gray-300 w-8 h-8 rounded-full flex items-center justify-center" data-product="garrafon-20l">
                           <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                             <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path>
                           </svg>
                         </button>
                         <span class="quantity-display w-8 text-center font-medium" data-product="garrafon-20l">0</span>
                         <button class="quantity-btn plus bg-[#0288c7] hover:bg-[#083049] text-white w-8 h-8 rounded-full flex items-center justify-center" data-product="garrafon-20l">
                           <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                             <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                           </svg>
                         </button>
                       </div>
                     </div>
                   </div>

                                     <div
                     class="product-card bg-white rounded-xl border-2 border-[#7dd5fc]/30 hover:border-[#0288c7] transition-all duration-300 p-6 hover:shadow-lg"
                   >
                     <div class="text-center">
                       <div
                         class="w-20 h-20 bg-[#bae7fd]/50 rounded-full flex items-center justify-center mx-auto mb-4"
                       >
                         <svg
                           class="w-10 h-10 text-[#0288c7]"
                           fill="none"
                           stroke="currentColor"
                           viewBox="0 0 24 24"
                         >
                           <path
                             stroke-linecap="round"
                             stroke-linejoin="round"
                             stroke-width="2"
                             d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
                           ></path>
                         </svg>
                       </div>
                       <h4 class="text-lg font-semibold text-[#083049] mb-2">
                         Botella 1L
                       </h4>
                       <p class="text-gray-600 text-sm mb-4">
                         Perfecta para llevar contigo
                       </p>
                       <p class="text-xl font-bold text-[#0288c7] mb-4">
                         $15.00
                       </p>
                       
                       <div class="flex items-center justify-center space-x-3">
                         <button class="quantity-btn minus bg-gray-200 hover:bg-gray-300 w-8 h-8 rounded-full flex items-center justify-center" data-product="botella-1l">
                           <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                             <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path>
                           </svg>
                         </button>
                         <span class="quantity-display w-8 text-center font-medium" data-product="botella-1l">0</span>
                         <button class="quantity-btn plus bg-[#0288c7] hover:bg-[#083049] text-white w-8 h-8 rounded-full flex items-center justify-center" data-product="botella-1l">
                           <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                             <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                           </svg>
                         </button>
                       </div>
                     </div>
                   </div>

                                     <div
                     class="product-card bg-white rounded-xl border-2 border-[#7dd5fc]/30 hover:border-[#0288c7] transition-all duration-300 p-6 hover:shadow-lg"
                   >
                     <div class="text-center">
                       <div
                         class="w-20 h-20 bg-[#bae7fd]/50 rounded-full flex items-center justify-center mx-auto mb-4"
                       >
                         <svg
                           class="w-10 h-10 text-[#0288c7]"
                           fill="none"
                           stroke="currentColor"
                           viewBox="0 0 24 24"
                         >
                           <path
                             stroke-linecap="round"
                             stroke-linejoin="round"
                             stroke-width="2"
                             d="M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"
                           ></path>
                         </svg>
                       </div>
                       <h4 class="text-lg font-semibold text-[#083049] mb-2">
                         Botella 500ml
                       </h4>
                       <p class="text-gray-600 text-sm mb-4">
                         Tamaño personal ideal
                       </p>
                       <p class="text-xl font-bold text-[#0288c7] mb-4">$8.00</p>
                       
                       <div class="flex items-center justify-center space-x-3">
                         <button class="quantity-btn minus bg-gray-200 hover:bg-gray-300 w-8 h-8 rounded-full flex items-center justify-center" data-product="botella-500ml">
                           <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                             <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path>
                           </svg>
                         </button>
                         <span class="quantity-display w-8 text-center font-medium" data-product="botella-500ml">0</span>
                         <button class="quantity-btn plus bg-[#0288c7] hover:bg-[#083049] text-white w-8 h-8 rounded-full flex items-center justify-center" data-product="botella-500ml">
                           <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                             <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                           </svg>
                         </button>
                       </div>
                     </div>
                   </div>

                                     <div
                     class="product-card bg-white rounded-xl border-2 border-[#7dd5fc]/30 hover:border-[#0288c7] transition-all duration-300 p-6 hover:shadow-lg"
                   >
                     <div class="text-center">
                       <div
                         class="w-20 h-20 bg-[#bae7fd]/50 rounded-full flex items-center justify-center mx-auto mb-4"
                       >
                         <svg
                           class="w-10 h-10 text-[#0288c7]"
                           fill="none"
                           stroke="currentColor"
                           viewBox="0 0 24 24"
                         >
                           <path
                             stroke-linecap="round"
                             stroke-linejoin="round"
                             stroke-width="2"
                             d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"
                           ></path>
                         </svg>
                       </div>
                       <h4 class="text-lg font-semibold text-[#083049] mb-2">
                         Pack Familiar
                       </h4>
                       <p class="text-gray-600 text-sm mb-4">
                         2 Garrafones + 6 Botellas 1L
                       </p>
                       <p class="text-xl font-bold text-[#0288c7] mb-4">
                         $130.00 <span class="text-sm text-gray-500 line-through"
                           >$140.00</span>
                       </p>
                       
                       <div class="flex items-center justify-center space-x-3">
                         <button class="quantity-btn minus bg-gray-200 hover:bg-gray-300 w-8 h-8 rounded-full flex items-center justify-center" data-product="pack-familiar">
                           <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                             <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path>
                           </svg>
                         </button>
                         <span class="quantity-display w-8 text-center font-medium" data-product="pack-familiar">0</span>
                         <button class="quantity-btn plus bg-[#0288c7] hover:bg-[#083049] text-white w-8 h-8 rounded-full flex items-center justify-center" data-product="pack-familiar">
                           <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                             <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                           </svg>
                         </button>
                       </div>
                     </div>
                   </div>
                </div>
              </div>
            </div>

            <!-- Cart Sidebar -->
            <div class="lg:col-span-1">
              <div class="slide-in-right sticky top-6">
                <!-- Cart -->
                <div
                  id="cart-panel"
                  class="bg-gradient-to-br from-[#bae7fd]/20 to-[#7dd5fc]/10 rounded-xl border border-[#7dd5fc]/30 p-6"
                >
                  <h3
                    class="text-lg font-semibold text-[#083049] mb-4 flex items-center"
                  >
                    <svg
                      class="w-5 h-5 mr-2 text-[#0288c7]"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.5 6h14.5M7 13v6a2 2 0 002 2h10a2 2 0 002-2v-6"
                      ></path>
                    </svg>
                    Tu Carrito
                  </h3>

                  <div id="cart-items" class="space-y-3 mb-4">
                    <p class="text-gray-600 text-sm text-center py-4">
                      Tu carrito está vacío
                    </p>
                  </div>

                  <div class="border-t border-[#7dd5fc]/30 pt-4">
                    <div
                      class="flex justify-between items-center text-lg font-semibold text-[#083049] mb-4"
                    >
                      <span>Total:</span>
                      <span id="cart-total">$0.00</span>
                    </div>

                    <button
                      id="proceed-checkout"
                      disabled
                      class="w-full bg-gray-300 text-gray-500 font-medium py-3 px-4 rounded-lg cursor-not-allowed transition-colors duration-300"
                    >
                      Proceder al Checkout
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Back Button -->
        <div class="mt-12 text-center">
          <a
            href="/solicitar"
            class="inline-flex items-center px-6 py-3 text-[#0288c7] border-2 border-[#0288c7] rounded-lg font-medium hover:bg-[#0288c7] hover:text-white transition-all duration-300 transform hover:scale-105"
          >
            <svg
              class="w-5 h-5 mr-2 transform rotate-180"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
            </svg>
            Volver a elegir método
          </a>
        </div>
      </div>
    </div>
  </SectionContainer>
</Layout>

<style>


  /* Product card effects */
  .product-card:hover {
    transform: translateY(-2px);
  }

  /* Button states */
  .add-to-cart-btn:hover {
    transform: scale(1.05);
  }


</style>

<script>
  // Product data
  const products = {
    'garrafon-20l': { name: 'Garrafón 20L', price: 25.00 },
    'botella-1l': { name: 'Botella 1L', price: 15.00 },
    'botella-500ml': { name: 'Botella 500ml', price: 8.00 },
    'pack-familiar': { name: 'Pack Familiar', price: 130.00 }
  };

  // Cart state and user
  let cart = {};
  let user = null;

  // Demo user data
  const demoUser = {
    name: "Javier Montero",
    email: "javier@example.com",
    phone: "961-123-4567",
  };

  // Initialize quantities
  Object.keys(products).forEach(productId => {
    cart[productId] = 0;
  });

  // Show/hide sections
  function showLoginSection() {
    document.getElementById("login-section").classList.remove("hidden");
    document.getElementById("register-section").classList.add("hidden");
    document.getElementById("shopping-section").classList.add("hidden");
  }

  function showRegisterSection() {
    document.getElementById("login-section").classList.add("hidden");
    document.getElementById("register-section").classList.remove("hidden");
    document.getElementById("shopping-section").classList.add("hidden");
  }

  function showShoppingSection() {
    document.getElementById("login-section").classList.add("hidden");
    document.getElementById("register-section").classList.add("hidden");
    document.getElementById("shopping-section").classList.remove("hidden");

    // Update user name
    document.getElementById("user-name").textContent = user.name;
    updateOrderSummary();
  }

  // Handle login/register toggle
  document
    .getElementById("show-register")
    .addEventListener("click", showRegisterSection);
  document
    .getElementById("show-login")
    .addEventListener("click", showLoginSection);

  // Handle login
  document
    .getElementById("login-form")
    .addEventListener("submit", function (e) {
      e.preventDefault();

      // Demo: accept any email/password
      user = { ...demoUser };
      showShoppingSection();
    });

  // Handle register
  document
    .getElementById("register-form")
    .addEventListener("submit", function (e) {
      e.preventDefault();

      const name = document.getElementById("reg-name").value;
      const email = document.getElementById("reg-email").value;
      const phone = document.getElementById("reg-phone").value;

      user = { name, email, phone };
      showShoppingSection();
    });

  // Handle logout
  document.getElementById("logout-btn").addEventListener("click", function () {
    user = null;
    // Reset cart
    Object.keys(products).forEach(productId => {
      cart[productId] = 0;
      updateQuantityDisplay(productId);
    });
    updateOrderSummary();
    showLoginSection();
  });

  // Update quantity display
  function updateQuantityDisplay(productId) {
    const display = document.querySelector('.quantity-display[data-product="' + productId + '"]');
    if (display) {
      display.textContent = cart[productId];
    }
  }

  // Update order summary
  function updateOrderSummary() {
    const summaryDiv = document.getElementById('cart-items');
    const totalPriceElement = document.getElementById('cart-total');
    const checkoutBtn = document.getElementById('proceed-checkout');
    const cartCountSpan = document.getElementById('cart-count');
    
    let total = 0;
    let hasItems = false;
    let totalItems = 0;
    let summaryHTML = '';

    Object.keys(cart).forEach(productId => {
      const quantity = cart[productId];
      if (quantity > 0) {
        hasItems = true;
        totalItems += quantity;
        const product = products[productId];
        const subtotal = quantity * product.price;
        total += subtotal;
        
        summaryHTML += '<div class="flex justify-between items-center bg-white/60 rounded-lg p-3">';
        summaryHTML += '<div class="flex-1">';
        summaryHTML += '<p class="font-medium text-sm text-[#083049]">' + product.name + '</p>';
        summaryHTML += '<p class="text-xs text-gray-600">' + quantity + ' x $' + product.price.toFixed(2) + '</p>';
        summaryHTML += '</div>';
        summaryHTML += '<div class="flex items-center space-x-2">';
        summaryHTML += '<span class="font-medium text-[#0288c7]">$' + subtotal.toFixed(2) + '</span>';
        summaryHTML += '</div>';
        summaryHTML += '</div>';
      }
    });

    if (hasItems) {
      summaryDiv.innerHTML = summaryHTML;
      totalPriceElement.textContent = '$' + total.toFixed(2);
      
      // Enable checkout
      checkoutBtn.disabled = false;
      checkoutBtn.className = "w-full bg-[#0288c7] hover:bg-[#083049] text-white font-medium py-3 px-4 rounded-lg transition-colors duration-300";
      checkoutBtn.textContent = "Proceder al Checkout";
    } else {
      summaryDiv.innerHTML = '<p class="text-gray-600 text-sm text-center py-4">Tu carrito está vacío</p>';
      totalPriceElement.textContent = '$0.00';
      
      // Disable checkout
      checkoutBtn.disabled = true;
      checkoutBtn.className = "w-full bg-gray-300 text-gray-500 font-medium py-3 px-4 rounded-lg cursor-not-allowed transition-colors duration-300";
      checkoutBtn.textContent = "Proceder al Checkout";
    }

    // Update cart count in header
    if (cartCountSpan) {
      cartCountSpan.textContent = totalItems.toString();
    }
  }

  // Handle quantity buttons
  document.addEventListener('click', function(e) {
    if (e.target.closest('.quantity-btn')) {
      const button = e.target.closest('.quantity-btn');
      const productId = button.dataset.product;
      const isPlus = button.classList.contains('plus');
      
      if (isPlus) {
        cart[productId]++;
      } else if (cart[productId] > 0) {
        cart[productId]--;
      }
      
      updateQuantityDisplay(productId);
      updateOrderSummary();
    }
  });

  // Handle checkout
  document
    .getElementById("proceed-checkout")
    .addEventListener("click", function () {
      const hasProducts = Object.keys(cart).some(id => cart[id] > 0);
      if (!hasProducts) return;

      alert(
        "¡Funcionalidad de checkout en desarrollo!\n\nEn una implementación real, aquí se verificaría la dirección del usuario y se procesaría el pedido."
      );
    });

  // Initialize
  updateOrderSummary();
</script>

